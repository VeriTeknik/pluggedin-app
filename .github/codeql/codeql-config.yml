# CodeQL Configuration for pluggedin-app
# This configuration helps CodeQL understand our custom security measures

name: "CodeQL config for pluggedin-app"

# Paths to exclude from analysis
paths-ignore:
  - node_modules
  - .next
  - out
  - public/pdf.worker.min.mjs
  - public/pdf.worker.mjs
  - "**/*.test.ts"
  - "**/*.test.tsx"
  - "**/tests/**"

# Query filters to reduce false positives
query-filters:
  - exclude:
      id: js/double-escaping
      # PDF.js worker files have their own escaping logic
  - exclude:
      problem.severity: recommendation
      
# Custom query suite
queries:
  - uses: security-and-quality
  
# Disable specific queries that produce false positives
disable-default-queries: false

# Additional documentation for reviewers
# Our application uses custom URL validation functions that sanitize input:
# - validateExternalUrl() - validates and sanitizes external URLs
# - validateInternalUrl() - validates URLs for internal registry APIs
# - validateTimeouts() - caps timeout values to prevent resource exhaustion
#
# These functions prevent SSRF attacks by:
# 1. Validating URL format and protocol
# 2. Checking against an allowlist of domains
# 3. Blocking private IP ranges
# 4. Preventing authentication credentials in URLs
# 5. Resolving DNS to prevent DNS rebinding attacks